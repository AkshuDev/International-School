<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="./css/dashboard.css" />

    <title>InterNational School</title>
    <link rel="icon" href="Assets/logo.png" type="image/x-icon" />
  </head>
  <body>
    <header>
      <div class="welcome">
        <a href="./index.html"
          ><img src="./Assets/logo-highres.png" alt="School Logo"
        /></a>
        <h3>InterNational School</h3>
      </div>
      <div class="user-dropdown">
        <div class="user-info">
          <img src="./Assets/user.png" alt="user img" />
          <div class="text">
            <h4>?Username</h4>
          </div>
        </div>

        <div class="dropdown-content">
          <a href="#">Profile</a>
          <a href="#">Settings</a>
          <a onclick="LogOut(event)">Logout</a>
        </div>
      </div>
    </header>

    <div class="dashboard-content">
      <div class="student-details-and-upcoming-events">
        <div class="student-details">
          <table class="student-details-table">
            <caption>
              Student Details
            </caption>
            <tr>
              <th>?Name:</th>
              <td id="student-name"></td>
            </tr>
            <tr>
              <th>?Class:</th>
              <td id="student-class"></td>
            </tr>
            <tr>
              <th>?Phone Number:</th>
              <td id="student-phone-number"></td>
            </tr>
            <tr>
              <th>?Admission Number:</th>
              <td id="student-admission-number"></td>
            </tr>
          </table>
          <img src="./Assets/user.png" alt="user img" />
        </div>
        <div class="upcoming-events">
          <h4>Upcoming Events</h4>
          <br />
          <div class="Legend">
            <p class="Event">Event</p>
            <p class="Exam">Exam</p>
            <p class="Holiday">Holiday</p>
          </div>
          <div class="data">
            <p class="EventText">Ad-Mad Show (10-Oct 2024)</p>
            <hr />
            <p class="ExamText">Mid-Term (21 Sept to 3 Oct 2024)</p>
            <hr />
            <p class="HolidayText">Mahatma Gandhi Jayanti (02-Oct)</p>
            <hr />
            <p class="HolidayText">Dusshera (12-Oct)</p>
            <hr />
            <p class="HolidayText">Guru Nanak Jayanti (15-Nov)</p>
            <hr />
          </div>
        </div>
      </div>
    </div>
    <script type="module">
      function checkLogin(event) {
        event.preventDefault();

        if (localStorage.getItem("user")) {
          localStorage.removeItem("user");
          localStorage.removeItem("UserDetails");
          window.location.href = "./index.html";
        } else {
          console.log("User is not logged in");
          window.location.href = "./login.html";
        }
      }
    </script>
    <script type="module">
      function getElementsStartingWithQuestionMark() {
        const elements = document.querySelectorAll("*:not(script):not(style)"); // Exclude scripts and styles
        const matchingElements = [];

        elements.forEach((element) => {
          if (element.textContent.startsWith("?")) {
            matchingElements.push(element);
          }
        });

        return matchingElements;
      }

      const elements = getElementsStartingWithQuestionMark();
      var username = [];
      var phone = [];
      var Name = [];
      var Admission_No = [];
      var DOB = [];
      var Grade = [];
      var NonIdentified = [];

      //Place Elements in desired arrays
      elements.forEach((element) => {
        const text = element.textContent.toLowerCase();

        if (text.includes("username")) {
          username.push(element);
          Admission_No.push(element);
        } else if (text.includes("phone")) {
          phone.push(element);
        } else if (text.includes("name")) {
          Name.push(element);
        } else if (text.includes("dob")) {
          DOB.push(element);
        } else if (text.includes("grade")) {
          Grade.push(element);
        } else {
          NonIdentified.push(element);
        }
      });

      //Get Data
      const data = JSON.parse(localStorage.getItem("UserDetails"));

      //Process text
      username.forEach((un) => {
        un.textContent = data.Admission_No;
      });
    </script>
    <script type="module">
      function LogOut(event) {
        event.preventDefault();

        if (localStorage.getItem("user")) {
          localStorage.removeItem("user");
          localStorage.removeItem("UserDetails");
          window.location.href = "./index.html";
        } else {
          console.log("User is not logged in");
          window.location.href = "./login.html";
        }
      }
    </script>
  </body>
</html>
